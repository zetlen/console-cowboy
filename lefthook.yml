# lefthook.yml
# Pre-commit hooks for Console Cowboy
# See: https://lefthook.dev/

commit-msg:
  jobs:
    - name: conventional-commit
      run: uv run cz check --commit-msg-file {1}

pre-commit:
  # Run formatting first (piped group), then other checks in parallel
  piped: true
  jobs:
    - name: ruff-format
      run: uv run ruff format {staged_files}
      stage_fixed: true
      glob: "*.py"

    - name: ruff-lint
      run: uv run ruff check --fix {staged_files}
      stage_fixed: true
      glob: "*.py"

    - name: cli-smoke-test
      run: uv run console-cowboy --help > /dev/null && uv run console-cowboy list > /dev/null
      glob: "*.py"

    - name: uv-lock-check
      run: uv lock --check
      glob:
        - "pyproject.toml"
        - "uv.lock"
